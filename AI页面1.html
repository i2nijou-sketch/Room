<html lang='zh-CN'>
        <head >
        <meta charset='UTF-8'/>
<meta name='viewport' content='width=device-width, initial-scale=1.0'/>
<title >OODaiPèŠå¤©å®¤</title>
<script src='https://res.gemcoder.com/js/reload.js'></script>
<script src='https://cdn.tailwindcss.com'></script>
<link href='https://cdn.bootcdn.net/ajax/libs/font-awesome/6.4.0/css/all.min.css' rel='stylesheet'/>
<script >tailwind.config = {
  theme: {
    extend: {
      colors: {
        primary: '#8B5A2B',
        // å¤å¤æ£•è‰²ä½œä¸ºä¸»è‰²è°ƒ
        secondary: '#4F7942',
        // å¤å¤ç»¿è‰²ä½œä¸ºè¾…åŠ©è‰²
        accent: '#E67E22',
        // å¤å¤æ©™è‰²ä½œä¸ºå¼ºè°ƒè‰²
        neutral: '#F5F5DC',
        // ç±³è‰²ä½œä¸ºä¸­æ€§è‰²
        dark: '#3E2723' // æ·±æ£•è‰²ä½œä¸ºæ·±è‰²
      },
      fontFamily: {
        retro: ['"Courier New"', 'monospace']
      },
      animation: {
        'float': 'float 6s ease-in-out infinite'
      },
      keyframes: {
        float: {
          '0%, 100%': {
            transform: 'translateY(0)'
          },
          '50%': {
            transform: 'translateY(-10px)'
          }
        }
      }
    }
  }
};</script>
<style type='text/tailwindcss'>
        @layer utilities {
            .text-shadow {
                text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.3);
            }
            .bg-texture {
                background-image: url("data:image/svg+xml,%3Csvg width='100' height='100' viewBox='0 0 100 100' xmlns='http://www.w3.org/2000/svg'%3E%3Cpath d='M11 18c3.866 0 7-3.134 7-7s-3.134-7-7-7-7 3.134-7 7 3.134 7 7 7zm48 25c3.866 0 7-3.134 7-7s-3.134-7-7-7-7 3.134-7 7 3.134 7 7 7zm-43-7c1.657 0 3-1.343 3-3s-1.343-3-3-3-3 1.343-3 3 1.343 3 3 3zm63 31c1.657 0 3-1.343 3-3s-1.343-3-3-3-3 1.343-3 3 1.343 3 3 3zM34 90c1.657 0 3-1.343 3-3s-1.343-3-3-3-3 1.343-3 3 1.343 3 3 3zm56-76c1.657 0 3-1.343 3-3s-1.343-3-3-3-3 1.343-3 3 1.343 3 3 3zM12 86c2.21 0 4-1.79 4-4s-1.79-4-4-4-4 1.79-4 4 1.79 4 4 4zm28-65c2.21 0 4-1.79 4-4s-1.79-4-4-4-4 1.79-4 4 1.79 4 4 4zm23-11c2.76 0 5-2.24 5-5s-2.24-5-5-5-5 2.24-5 5 2.24 5 5 5zm-6 60c2.21 0 4-1.79 4-4s-1.79-4-4-4-4 1.79-4 4 1.79 4 4 4zm29 22c2.76 0 5-2.24 5-5s-2.24-5-5-5-5 2.24-5 5 2.24 5 5 5zM32 63c2.76 0 5-2.24 5-5s-2.24-5-5-5-5 2.24-5 5 2.24 5 5 5zm57-13c2.76 0 5-2.24 5-5s-2.24-5-5-5-5 2.24-5 5 2.24 5 5 5zm-9-21c1.105 0 2-.895 2-2s-.895-2-2-2-2 .895-2 2 .895 2 2 2zM60 91c1.105 0 2-.895 2-2s-.895-2-2-2-2 .895-2 2 .895 2 2 2zM35 41c1.105 0 2-.895 2-2s-.895-2-2-2-2 .895-2 2 .895 2 2 2zM12 60c1.105 0 2-.895 2-2s-.895-2-2-2-2 .895-2 2 .895 2 2 2z' fill='%239C92AC' fill-opacity='0.05' fill-rule='evenodd'/%3E%3C/svg%3E");
            }
            .scrollbar-thin {
                scrollbar-width: thin;
            }
            .scrollbar-thumb-rounded {
                scrollbar-color: rgba(139, 90, 43, 0.5) transparent;
            }
            .scrollbar-thumb-rounded::-webkit-scrollbar-thumb {
                border-radius: 9999px;
                background-color: rgba(139, 90, 43, 0.5);
            }
            .scrollbar-hide::-webkit-scrollbar {
                display: none;
            }
            .scrollbar-hide {
                -ms-overflow-style: none;
                scrollbar-width: none;
            }
        }
    </style>
    </head>
<body class='bg-neutral bg-texture min-h-screen font-retro text-dark overflow-x-hidden'>
        <!-- [MODULE] a1b_ä¸»åº”ç”¨å®¹å™¨ -->
<div class='flex flex-col min-h-screen max-w-7xl mx-auto w-full shadow-xl'>
        <!-- [MODULE] c3d_åº”ç”¨å¤´éƒ¨ -->
<header class='bg-primary text-white py-4 px-6 shadow-md relative overflow-hidden'>
        <div class='absolute top-0 right-0 w-32 h-32 bg-accent/20 rounded-full -mr-16 -mt-16 animate-float'>
        </div>
<div class='absolute bottom-0 left-0 w-24 h-24 bg-secondary/20 rounded-full -ml-12 -mb-12 animate-float' style='animation-delay: 2s'>
        </div>
<div class='container mx-auto flex justify-between items-center relative z-10'>
        <div class='flex items-center space-x-3'>
        <i class='fas fa-comments text-2xl text-accent'>
        </i>
<h1 class='text-[clamp(1.5rem,3vw,2.5rem)] font-bold text-shadow'>
        OODaiPèŠå¤©å®¤
    </h1>
    </div>
<div id='user-info' class='hidden items-center space-x-4'>
        <span class='hidden md:inline-block px-3 py-1 bg-secondary/30 rounded-full text-sm'>
        <i class='fas fa-user mr-1'>
        </i>
<span id='current-user'>
        </span>
    </span>
<button id='logout-btn' class='px-4 py-2 bg-accent hover:bg-accent/80 rounded-full transition-all duration-300 flex items-center shadow-md hover:shadow-lg transform hover:-translate-y-0.5'>
        <i class='fas fa-sign-out-alt mr-2'>
        </i>
<span class='hidden sm:inline'>
        é€€å‡º
    </span>
    </button>
    </div>
    </div>
    </header>
<!-- [/MODULE] c3d_åº”ç”¨å¤´éƒ¨ -- åŒ…å«åº”ç”¨æ ‡é¢˜å’Œç”¨æˆ·ä¿¡æ¯åŒºåŸŸ -->
<!-- [MODULE] e5f_ä¸»å†…å®¹åŒºåŸŸ -->
<main class='flex-grow flex flex-col md:flex-row'>
        <!-- [MODULE] f7g_ç™»å½•ç•Œé¢ -->
<div id='login-screen' class='flex-grow flex flex-col items-center justify-center p-6'>
        <div class='w-full max-w-md bg-white/90 backdrop-blur-sm rounded-2xl shadow-2xl p-8 border-2 border-primary/20 transform transition-all duration-500 hover:shadow-primary/20'>
        <div class='text-center mb-8'>
        <div class='inline-block p-4 bg-primary/10 rounded-full mb-4'>
        <i class='fas fa-comments text-4xl text-primary'>
        </i>
    </div>
<h2 class='text-2xl md:text-3xl font-bold text-primary mb-2'>
        æ¬¢è¿æ¥åˆ°èŠå¤©å®¤
    </h2>
<p class='text-gray-600'>
        è¯·ç™»å½•åå¼€å§‹èŠå¤©
    </p>
    </div>
<form id='login-form' class='space-y-6'>
        <div class='space-y-2'>
        <label for='nickname' class='block text-sm font-medium text-gray-700'>
        æ˜µç§°
    </label>
<div class='relative'>
        <div class='absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none'>
        <i class='fas fa-user text-primary/70'>
        </i>
    </div>
<input type='text' id='nickname' name='nickname' required class='w-full pl-10 pr-4 py-3 rounded-lg border-2 border-gray-300 focus:border-primary focus:ring-2 focus:ring-primary/20 transition-all duration-300 outline-none' placeholder='è¯·è¾“å…¥æ‚¨çš„æ˜µç§°'/>
    </div>
    </div>
<div class='space-y-2'>
        <label for='password' class='block text-sm font-medium text-gray-700'>
        å¯†ç 
    </label>
<div class='relative'>
        <div class='absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none'>
        <i class='fas fa-lock text-primary/70'>
        </i>
    </div>
<input type='password' id='password' name='password' required class='w-full pl-10 pr-4 py-3 rounded-lg border-2 border-gray-300 focus:border-primary focus:ring-2 focus:ring-primary/20 transition-all duration-300 outline-none' placeholder='è¯·è¾“å…¥å¯†ç '/>
    </div>
<p class='text-xs text-gray-500 italic'>
        æç¤ºï¼šå›ºå®šå¯†ç ä¸º 123456
    </p>
    </div>
<div class='space-y-2'>
        <label for='server' class='block text-sm font-medium text-gray-700'>
        æœåŠ¡å™¨åœ°å€ 
    </label>
<div class='relative'>
        <div class='absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none'>
        <i class='fas fa-server text-primary/70'>
        </i>
    </div>
<select id='server' name='server' required class='w-full pl-10 pr-10 py-3 rounded-lg border-2 border-gray-300 focus:border-primary focus:ring-2 focus:ring-primary/20 transition-all duration-300 outline-none appearance-none bg-white'>
        <option value disabled selected>
        é€‰æ‹©æœåŠ¡å™¨
    </option>
<option value='http://localhost:8000/'>
        æœ¬åœ°æœåŠ¡å™¨ï¼ˆhttpï¼‰
    </option>
<option value='http://60edhvs70h5u.ngrok.xiaomiqiu123.top/'>
        å…¬ç½‘æœåŠ¡å™¨ï¼ˆhttpï¼‰
    </option>
    </select>
<div class='absolute inset-y-0 right-0 pr-3 flex items-center pointer-events-none'>
        <i class='fas fa-chevron-down text-primary/50'>
        </i>
    </div>
    </div>
    </div>
<button type='submit' class='w-full py-3 bg-primary hover:bg-primary/90 text-white font-bold rounded-lg transition-all duration-300 transform hover:scale-[1.02] active:scale-[0.98] shadow-md hover:shadow-lg flex items-center justify-center'>
        <i class='fas fa-sign-in-alt mr-2'>
        </i>
<span >
        ç™»å½•
    </span>
    </button>
    </form>
<div class='mt-6 pt-6 border-t border-gray-200 text-center text-sm text-gray-600'>
        <p >
        ç™»å½•å³è¡¨ç¤ºæ‚¨åŒæ„æˆ‘ä»¬çš„
<a href='javascript:void(0);' class='text-primary hover:underline'>
        ä½¿ç”¨æ¡æ¬¾
    </a>
å’Œ
<a href='javascript:void(0);' class='text-primary hover:underline'>
        éšç§æ”¿ç­–
    </a>
    </p>
    </div>
    </div>
<div class='mt-8 text-center text-gray-500 text-sm max-w-md'>
        <p >
        Â© 2023 OODaiPèŠå¤©å®¤ | å¤å¤å“‘å…‰é£æ ¼è®¾è®¡
    </p>
    </div>
    </div>
<!-- [/MODULE] f7g_ç™»å½•ç•Œé¢ -- åŒ…å«ç”¨æˆ·ç™»å½•è¡¨å•ï¼Œéœ€è¦è¾“å…¥æ˜µç§°ã€å¯†ç (å›ºå®šå¯†ç 123456)å’Œé€‰æ‹©æœåŠ¡å™¨åœ°å€ -->
<!-- [MODULE] h9i_èŠå¤©å®¤ç•Œé¢ -->
<div id='chat-screen' class='hidden flex-grow flex flex-col h-[calc(100vh-100px)]'>
        <!-- [MODULE] j0k_èŠå¤©æ¶ˆæ¯åŒºåŸŸ -->
<div class='flex-grow flex flex-col md:flex-row overflow-hidden border-t border-primary/10'>
        <!-- [MODULE] l2m_ç”¨æˆ·åˆ—è¡¨ -->
<div class='w-full md:w-64 bg-white/80 backdrop-blur-sm border-r border-primary/10 hidden md:block'>
        <div class='p-4 border-b border-primary/10'>
        <h3 class='font-bold text-lg text-primary flex items-center'>
        <i class='fas fa-users mr-2'>
        </i>
åœ¨çº¿ç”¨æˆ·
    </h3>
<p class='text-xs text-gray-500 mt-1'>
        å½“å‰
<span id='user-count'>
        0
    </span>
äººåœ¨çº¿
    </p>
    </div>
<div id='user-list' class='p-2 overflow-y-auto h-[calc(100%-60px)] scrollbar-thin scrollbar-thumb-rounded'>
        <!-- ç”¨æˆ·åˆ—è¡¨å°†é€šè¿‡JSåŠ¨æ€ç”Ÿæˆ -->
<div class='text-center text-gray-400 py-10 text-sm'>
        <i class='fas fa-spinner fa-spin mr-2'>
        </i>
æ­£åœ¨è¿æ¥æœåŠ¡å™¨...
    </div>
    </div>
    </div>
<!-- [/MODULE] l2m_ç”¨æˆ·åˆ—è¡¨ -- æ˜¾ç¤ºå½“å‰åœ¨çº¿ç”¨æˆ·åˆ—è¡¨å’Œåœ¨çº¿äººæ•°ç»Ÿè®¡ -->
<!-- [MODULE] n4o_èŠå¤©æ¶ˆæ¯æ˜¾ç¤ºåŒºåŸŸ -->
<div class='flex-grow flex flex-col overflow-hidden'>
        <div id='message-container' class='flex-grow p-4 overflow-y-auto scrollbar-thin scrollbar-thumb-rounded bg-white/50'>
        <!-- ç³»ç»Ÿæ¶ˆæ¯ -->
<div class='system-message my-4'>
        <div class='flex items-center justify-center'>
        <span class='px-4 py-1 bg-primary/10 text-primary text-xs rounded-full'>
        æ¬¢è¿æ¥åˆ°OODaiPèŠå¤©å®¤
    </span>
    </div>
    </div>
<!-- æ¶ˆæ¯å°†é€šè¿‡JSåŠ¨æ€ç”Ÿæˆ -->
<div id='empty-state' class='text-center py-16 text-gray-400'>
        <div class='inline-block p-6 bg-gray-100 rounded-full mb-4'>
        <i class='fas fa-comment-dots text-3xl'>
        </i>
    </div>
<p >
        å¼€å§‹å‘é€æ¶ˆæ¯ï¼ŒåŠ å…¥èŠå¤©å§ï¼
    </p>
<p class='text-xs mt-2'>
        æ”¯æŒ@åŠŸèƒ½ï¼š@æˆå°ç† @éŸ³ä¹ä¸€ä¸‹ @ç”µå½± @å¤©æ°” @æ–°é—» @å°è§†é¢‘
    </p>
    </div>
    </div>
<!-- [/MODULE] n4o_èŠå¤©æ¶ˆæ¯æ˜¾ç¤ºåŒºåŸŸ -- æ˜¾ç¤ºèŠå¤©æ¶ˆæ¯ï¼Œæ”¯æŒæ»šåŠ¨æŸ¥çœ‹å†å²æ¶ˆæ¯ -->
<!-- [MODULE] p6q_èŠå¤©è¾“å…¥åŒºåŸŸ -->
<div class='border-t border-primary/10 p-4 bg-white/90'>
        <div class='flex mb-3'>
        <button id='emoji-btn' class='p-2 text-gray-600 hover:text-primary hover:bg-primary/10 rounded-full transition-colors'>
        <i class='far fa-smile'>
        </i>
    </button>
<button id='history-btn' class='p-2 text-gray-600 hover:text-primary hover:bg-primary/10 rounded-full transition-colors'>
        <i class='fas fa-history'>
        </i>
    </button>
<div class='flex-grow'>
        </div>
<div class='flex space-x-2'>
        <button id='mobile-user-list-btn' class='md:hidden p-2 text-gray-600 hover:text-primary hover:bg-primary/10 rounded-full transition-colors'>
        <i class='fas fa-users'>
        </i>
    </button>
    </div>
    </div>
<div class='relative'>
        <textarea id='message-input' rows='3' class='w-full pr-24 pl-4 py-3 rounded-xl border-2 border-gray-200 focus:border-primary focus:ring-2 focus:ring-primary/20 transition-all outline-none resize-none scrollbar-thin scrollbar-thumb-rounded' placeholder='è¾“å…¥æ¶ˆæ¯... æ”¯æŒ@åŠŸèƒ½'>
        </textarea>
<button id='send-btn' class='absolute right-2 bottom-2 bg-primary hover:bg-primary/90 text-white rounded-full px-4 py-2 transition-all duration-300 flex items-center shadow-md hover:shadow-lg transform hover:-translate-y-0.5'>
        <i class='fas fa-paper-plane mr-1'>
        </i>
    </button>
    </div>
<div class='flex justify-between items-center mt-2 text-xs text-gray-500'>
        <div >
        <span id='char-count'>
        0
    </span>
/ 500 å­—ç¬¦
    </div>
<div >
        <span class='mr-3'>
        <i class='fas fa-at mr-1'>
        </i>
æ”¯æŒ@æåŠ
    </span>
<span >
        <i class='fas fa-smile mr-1'>
        </i>
æ”¯æŒè¡¨æƒ…
    </span>
    </div>
    </div>
    </div>
<!-- [/MODULE] p6q_èŠå¤©è¾“å…¥åŒºåŸŸ -- æä¾›æ¶ˆæ¯è¾“å…¥æ¡†å’Œå‘é€æŒ‰é’®ï¼Œæ”¯æŒè¡¨æƒ…å’Œå†å²è®°å½•åŠŸèƒ½ -->
    </div>
<!-- [/MODULE] p6q_èŠå¤©è¾“å…¥åŒºåŸŸ -->
    </div>
<!-- [/MODULE] j0k_èŠå¤©æ¶ˆæ¯åŒºåŸŸ -->
    </div>
<!-- [/MODULE] h9i_èŠå¤©å®¤ç•Œé¢ -- åŒ…å«ç”¨æˆ·åˆ—è¡¨ã€æ¶ˆæ¯æ˜¾ç¤ºåŒºåŸŸå’Œæ¶ˆæ¯è¾“å…¥åŒºåŸŸ -->
    </main>
<!-- [/MODULE] e5f_ä¸»å†…å®¹åŒºåŸŸ -- æ ¹æ®ç™»å½•çŠ¶æ€æ˜¾ç¤ºç™»å½•ç•Œé¢æˆ–èŠå¤©å®¤ç•Œé¢ -->
<!-- [MODULE] r8s_ç§»åŠ¨ç«¯ç”¨æˆ·åˆ—è¡¨å¼¹çª— -->
<div id='mobile-user-modal' class='fixed inset-0 bg-black/50 z-50 hidden flex items-end'>
        <div class='bg-white w-full max-h-[70vh] rounded-t-3xl shadow-2xl transform transition-transform duration-300 translate-y-full' id='modal-content'>
        <div class='p-4 border-b flex justify-between items-center'>
        <h3 class='font-bold text-lg'>
        åœ¨çº¿ç”¨æˆ·
    </h3>
<button id='close-modal' class='p-2 text-gray-500 hover:text-gray-700'>
        <i class='fas fa-times'>
        </i>
    </button>
    </div>
<div id='mobile-user-list' class='p-2 overflow-y-auto h-[calc(70vh-60px)] scrollbar-thin scrollbar-thumb-rounded'>
        <!-- ç§»åŠ¨ç«¯ç”¨æˆ·åˆ—è¡¨å°†é€šè¿‡JSåŠ¨æ€ç”Ÿæˆ -->
    </div>
    </div>
    </div>
<!-- [/MODULE] r8s_ç§»åŠ¨ç«¯ç”¨æˆ·åˆ—è¡¨å¼¹çª— -- åœ¨ç§»åŠ¨è®¾å¤‡ä¸Šç‚¹å‡»ç”¨æˆ·åˆ—è¡¨æŒ‰é’®æ—¶æ˜¾ç¤ºï¼Œå±•ç¤ºåœ¨çº¿ç”¨æˆ· -->
<!-- [MODULE] t9u_è¡¨æƒ…é€‰æ‹©å™¨ -->
<div id='emoji-picker' class='fixed bottom-24 left-4 md:left-auto md:right-4 w-64 bg-white rounded-xl shadow-xl border border-gray-200 z-40 hidden transform transition-all duration-300'>
        <div class='p-3 border-b flex justify-between items-center'>
        <h4 class='font-medium'>
        è¡¨æƒ…
    </h4>
<button id='close-emoji' class='text-gray-400 hover:text-gray-600'>
        <i class='fas fa-times'>
        </i>
    </button>
    </div>
<div class='p-2 overflow-y-auto h-64 scrollbar-thin scrollbar-thumb-rounded' id='emoji-container'>
        <!-- è¡¨æƒ…å°†é€šè¿‡JSåŠ¨æ€ç”Ÿæˆ -->
    </div>
    </div>
<!-- [/MODULE] t9u_è¡¨æƒ…é€‰æ‹©å™¨ -- ç‚¹å‡»è¡¨æƒ…æŒ‰é’®æ—¶æ˜¾ç¤ºï¼Œå…è®¸ç”¨æˆ·é€‰æ‹©å¹¶æ’å…¥è¡¨æƒ… -->
<!-- [MODULE] v0w_æç¤ºæ¡† -->
<div id='toast-container' class='fixed top-4 right-4 z-50 flex flex-col space-y-3'>
        </div>
<!-- [/MODULE] v0w_æç¤ºæ¡† -- æ˜¾ç¤ºæ“ä½œç»“æœæç¤ºä¿¡æ¯ -->
    </div>
<!-- [/MODULE] a1b_ä¸»åº”ç”¨å®¹å™¨ -- åŒ…å«æ•´ä¸ªåº”ç”¨çš„æ‰€æœ‰å†…å®¹ -->
<!-- [JSMOD] x2y_ç™»å½•åŠŸèƒ½ -->
<script id='login-script'>document.addEventListener('DOMContentLoaded', function () {
  // DOMå…ƒç´ 
  var loginScreen = document.getElementById('login-screen');
  var chatScreen = document.getElementById('chat-screen');
  var loginForm = document.getElementById('login-form');
  var nicknameInput = document.getElementById('nickname');
  var passwordInput = document.getElementById('password');
  var serverSelect = document.getElementById('server');
  var userInfo = document.getElementById('user-info');
  var currentUser = document.getElementById('current-user');
  var logoutBtn = document.getElementById('logout-btn');
  var toastContainer = document.getElementById('toast-container');
  // æ£€æŸ¥æœ¬åœ°å­˜å‚¨ä¸­æ˜¯å¦æœ‰ç”¨æˆ·ä¿¡æ¯
  var savedUser = localStorage.getItem('chatUser');
  if (savedUser) {
    try {
      var user = JSON.parse(savedUser);
      if (user.nickname && user.server) {
        nicknameInput.value = user.nickname;
        serverSelect.value = user.server;
      }
    } catch (e) {
      console.error('è§£æç”¨æˆ·ä¿¡æ¯å¤±è´¥', e);
    }
  }
  // ç™»å½•è¡¨å•æäº¤å¤„ç†
  loginForm.addEventListener('submit', function (e) {
    e.preventDefault();
    var nickname = nicknameInput.value.trim();
    var password = passwordInput.value.trim();
    var server = serverSelect.value;

    // éªŒè¯è¾“å…¥
    if (!nickname) {
      showToast('è¯·è¾“å…¥æ˜µç§°', 'error');
      nicknameInput.focus();
      return;
    }
    if (password !== '123456') {
      showToast('å¯†ç é”™è¯¯ï¼Œå›ºå®šå¯†ç ä¸º123456', 'error');
      passwordInput.focus();
      return;
    }
    if (!server) {
      showToast('è¯·é€‰æ‹©æœåŠ¡å™¨', 'error');
      serverSelect.focus();
      return;
    }

    // ä¿å­˜ç”¨æˆ·ä¿¡æ¯åˆ°æœ¬åœ°å­˜å‚¨
    localStorage.setItem('chatUser', JSON.stringify({
      nickname: nickname,
      server: server
    }));

    // æ›´æ–°UIï¼Œåˆ‡æ¢åˆ°èŠå¤©ç•Œé¢
    currentUser.textContent = nickname;
    userInfo.classList.remove('hidden');
    userInfo.classList.add('flex');
    loginScreen.classList.add('hidden');
    chatScreen.classList.remove('hidden');

    // è¿æ¥WebSocketæœåŠ¡å™¨ï¼ˆå®é™…é¡¹ç›®ä¸­è¿™é‡Œä¼šæœ‰çœŸå®çš„è¿æ¥ä»£ç ï¼‰
    connectToServer(server, nickname);

    // æ˜¾ç¤ºç™»å½•æˆåŠŸæç¤º
    showToast("\u6B22\u8FCE\u56DE\u6765\uFF0C".concat(nickname, "\uFF01"), 'success');
  });

  // é€€å‡ºç™»å½•å¤„ç†
  logoutBtn.addEventListener('click', function () {
    // æ–­å¼€WebSocketè¿æ¥ï¼ˆå®é™…é¡¹ç›®ä¸­è¿™é‡Œä¼šæœ‰çœŸå®çš„æ–­å¼€è¿æ¥ä»£ç ï¼‰
    if (window.ws && window.ws.readyState === WebSocket.OPEN) {
      window.ws.close(1000, 'ç”¨æˆ·ä¸»åŠ¨é€€å‡º');
    }

    // æ¸…ç©ºç”¨æˆ·ä¿¡æ¯
    localStorage.removeItem('chatUser');

    // é‡ç½®è¡¨å•
    loginForm.reset();

    // æ›´æ–°UIï¼Œåˆ‡æ¢åˆ°ç™»å½•ç•Œé¢
    chatScreen.classList.add('hidden');
    loginScreen.classList.remove('hidden');
    userInfo.classList.add('hidden');
    userInfo.classList.remove('flex');

    // æ˜¾ç¤ºé€€å‡ºæˆåŠŸæç¤º
    showToast('å·²é€€å‡ºç™»å½•', 'info');
  });

  // æ˜¾ç¤ºæç¤ºæ¡†
  function showToast(message) {
    var type = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : 'info';
    var toast = document.createElement('div');

    // è®¾ç½®æ ·å¼å’Œç±»å‹
    var typeClasses = {
      success: 'bg-green-500',
      error: 'bg-red-500',
      info: 'bg-primary',
      warning: 'bg-yellow-500'
    };
    toast.className = "toast px-4 py-3 rounded-lg shadow-lg text-white flex items-center transform transition-all duration-500 translate-x-full opacity-0".concat(typeClasses[type] || typeClasses.info);

    // è®¾ç½®å›¾æ ‡
    var icons = {
      success: 'fa-check-circle',
      error: 'fa-exclamation-circle',
      info: 'fa-info-circle',
      warning: 'fa-exclamation-triangle'
    };
    toast.innerHTML = "<i class=\"fas".concat(icons[type] || icons.info, "mr-2\"></i>\n                    <span>").concat(message, "</span>");

    // æ·»åŠ åˆ°å®¹å™¨
    toastContainer.appendChild(toast);

    // æ˜¾ç¤ºåŠ¨ç”»
    setTimeout(function () {
      toast.classList.remove('translate-x-full', 'opacity-0');
    }, 10);

    // è‡ªåŠ¨å…³é—­
    setTimeout(function () {
      toast.classList.add('translate-x-full', 'opacity-0');
      setTimeout(function () {
        toast.remove();
      }, 500);
    }, 3000);
  }

  // è¿æ¥æœåŠ¡å™¨ï¼ˆæ¨¡æ‹Ÿï¼‰
  function connectToServer(server, nickname) {
    // æ¨¡æ‹ŸWebSocketè¿æ¥
    window.ws = {
      readyState: WebSocket.OPEN,
      close: function close() {}
    };

    // æ¨¡æ‹Ÿè¿æ¥æˆåŠŸåè·å–ç”¨æˆ·åˆ—è¡¨
    setTimeout(function () {
      updateUserList([{
        id: 1,
        name: nickname,
        isSelf: true
      }, {
        id: 2,
        name: 'æˆå°ç†',
        isSelf: false
      }, {
        id: 3,
        name: 'éŸ³ä¹ä¸€ä¸‹',
        isSelf: false
      }, {
        id: 4,
        name: 'ç”µå½±çˆ±å¥½è€…',
        isSelf: false
      }, {
        id: 5,
        name: 'å¤©æ°”æ’­æŠ¥å‘˜',
        isSelf: false
      }, {
        id: 6,
        name: 'æ–°é—»é€Ÿé€’',
        isSelf: false
      }, {
        id: 7,
        name: 'å°è§†é¢‘åˆ†äº«',
        isSelf: false
      }, {
        id: 8,
        name: 'å¤å¤é£',
        isSelf: false
      }]);
    }, 1000);

    // æ¨¡æ‹Ÿæ”¶åˆ°æ¶ˆæ¯
    setTimeout(function () {
      receiveMessage({
        id: 1,
        user: {
          id: 2,
          name: 'æˆå°ç†'
        },
        content: 'å¤§å®¶å¥½å•Šï¼æ¬¢è¿æ–°æœ‹å‹åŠ å…¥èŠå¤©å®¤ï¼',
        timestamp: new Date().toISOString()
      });
    }, 2000);
    setTimeout(function () {
      receiveMessage({
        id: 2,
        user: {
          id: 3,
          name: 'éŸ³ä¹ä¸€ä¸‹'
        },
        content: 'ä»Šå¤©æ¨èä¸€é¦–å¤å¤é£çš„æ­Œæ›²ç»™å¤§å®¶ ğŸµ',
        timestamp: new Date().toISOString()
      });
    }, 4000);
  }
});
// [/JSMOD] x2y_ç™»å½•åŠŸèƒ½ -- å¤„ç†ç”¨æˆ·ç™»å½•å’Œé€€å‡ºé€»è¾‘ï¼Œç®¡ç†WebSocketè¿æ¥çŠ¶æ€</script>
<!-- [JSMOD] z3a_èŠå¤©åŠŸèƒ½ -->
<script id='chat-script'>document.addEventListener('DOMContentLoaded', function () {
  // DOMå…ƒç´ 
  var messageInput = document.getElementById('message-input');
  var sendBtn = document.getElementById('send-btn');
  var messageContainer = document.getElementById('message-container');
  var userList = document.getElementById('user-list');
  var userCount = document.getElementById('user-count');
  var charCount = document.getElementById('char-count');
  var emptyState = document.getElementById('empty-state');
  var historyBtn = document.getElementById('history-btn');

  // è¾“å…¥å­—ç¬¦è®¡æ•°
  messageInput.addEventListener('input', function () {
    var count = messageInput.value.length;
    charCount.textContent = count;

    // é™åˆ¶æœ€å¤§é•¿åº¦
    if (count > 500) {
      messageInput.value = messageInput.value.substring(0, 500);
      charCount.textContent = 500;
    }

    // æ”¹å˜è®¡æ•°é¢œè‰²
    if (count > 450) {
      charCount.classList.add('text-red-500');
    } else {
      charCount.classList.remove('text-red-500');
    }
  });

  // å‘é€æ¶ˆæ¯
  sendBtn.addEventListener('click', sendMessage);

  // æŒ‰Enterå‘é€æ¶ˆæ¯ï¼ŒShift+Enteræ¢è¡Œ
  messageInput.addEventListener('keydown', function (e) {
    if (e.key === 'Enter' && !e.shiftKey) {
      e.preventDefault();
      sendMessage();
    }
  });

  // å‘é€æ¶ˆæ¯å‡½æ•°
  function sendMessage() {
    var content = messageInput.value.trim();
    if (!content) return;

    // æ¸…ç©ºè¾“å…¥æ¡†
    messageInput.value = '';
    charCount.textContent = '0';

    // éšè—ç©ºçŠ¶æ€æç¤º
    if (emptyState) {
      emptyState.remove();
    }

    // è·å–å½“å‰ç”¨æˆ·ä¿¡æ¯ï¼ˆå®é™…é¡¹ç›®ä¸­ä»ç™»å½•çŠ¶æ€è·å–ï¼‰
    var currentUser = {
      id: 1,
      name: document.getElementById('current-user').textContent
    };

    // åˆ›å»ºæ¶ˆæ¯å¯¹è±¡
    var message = {
      id: Date.now(),
      user: currentUser,
      content: content,
      timestamp: new Date().toISOString(),
      isSelf: true
    };

    // æ·»åŠ æ¶ˆæ¯åˆ°ç•Œé¢
    addMessageToUI(message);

    // æ»šåŠ¨åˆ°åº•éƒ¨
    scrollToBottom();

    // æ¨¡æ‹Ÿå‘é€åˆ°æœåŠ¡å™¨å¹¶æ¥æ”¶ï¼ˆå®é™…é¡¹ç›®ä¸­è¿™é‡Œä¼šæœ‰çœŸå®çš„WebSocketå‘é€ä»£ç ï¼‰
    setTimeout(function () {
      // æ£€æŸ¥æ˜¯å¦æœ‰@å‘½ä»¤
      var atCommands = ['@æˆå°ç†', '@éŸ³ä¹ä¸€ä¸‹', '@ç”µå½±', '@å¤©æ°”', '@æ–°é—»', '@å°è§†é¢‘'];
      var hasCommand = false;
      atCommands.forEach(function (command) {
        if (content.includes(command)) {
          hasCommand = true;

          // æ¨¡æ‹Ÿå‘½ä»¤å“åº”
          var responses = {
            '@æˆå°ç†': 'ä½ @æˆ‘äº†ï¼Ÿæœ‰ä»€ä¹ˆäº‹å—ï¼ŸğŸ˜Š',
            '@éŸ³ä¹ä¸€ä¸‹': 'æ­£åœ¨ä¸ºä½ æ’­æ”¾éŸ³ä¹... ğŸ¶ï¼ˆåŠŸèƒ½å¼€å‘ä¸­ï¼‰',
            '@ç”µå½±': 'æ¨èç”µå½±ï¼šã€Šå¤å¤å¹´ä»£ã€‹ï¼ˆåŠŸèƒ½å¼€å‘ä¸­ï¼‰',
            '@å¤©æ°”': 'ä»Šå¤©å¤©æ°”æ™´æœ—ï¼Œæ¸©åº¦25Â°Cï¼ˆåŠŸèƒ½å¼€å‘ä¸­ï¼‰',
            '@æ–°é—»': 'æœ€æ–°æ–°é—»ï¼šèŠå¤©å®¤äººæ•°çªç ´100äººï¼ï¼ˆåŠŸèƒ½å¼€å‘ä¸­ï¼‰',
            '@å°è§†é¢‘': 'ä¸ºä½ æ’­æ”¾çƒ­é—¨å°è§†é¢‘... ğŸ¬ï¼ˆåŠŸèƒ½å¼€å‘ä¸­ï¼‰'
          };

          // åˆ›å»ºå“åº”æ¶ˆæ¯
          var responseUser = {
            id: 0,
            name: command.substring(1)
          };
          var responseMessage = {
            id: Date.now() + 1,
            user: responseUser,
            content: responses[command],
            timestamp: new Date().toISOString(),
            isSelf: false
          };

          // æ·»åŠ å“åº”æ¶ˆæ¯åˆ°ç•Œé¢
          setTimeout(function () {
            addMessageToUI(responseMessage);
            scrollToBottom();
          }, 1000);
        }
      });

      // å¦‚æœæ²¡æœ‰å‘½ä»¤ï¼Œæ¨¡æ‹Ÿå…¶ä»–ç”¨æˆ·å›å¤
      if (!hasCommand && Math.random() > 0.3) {
        var randomUsers = [{
          id: 2,
          name: 'æˆå°ç†'
        }, {
          id: 3,
          name: 'éŸ³ä¹ä¸€ä¸‹'
        }, {
          id: 4,
          name: 'ç”µå½±çˆ±å¥½è€…'
        }, {
          id: 5,
          name: 'å¤©æ°”æ’­æŠ¥å‘˜'
        }];
        var randomUser = randomUsers[Math.floor(Math.random() * randomUsers.length)];
        var replies = ['è¯´å¾—å¯¹ï¼', 'æˆ‘åŒæ„ä½ çš„è§‚ç‚¹', 'å“ˆå“ˆï¼Œå¤ªæœ‰è¶£äº†', 'çœŸçš„å—ï¼Ÿ', 'ä¸é”™çš„æƒ³æ³•', 'æˆ‘ä¹Ÿæ˜¯è¿™ä¹ˆæƒ³çš„', 'å¤ªæ£’äº†ï¼'];
        var randomReply = replies[Math.floor(Math.random() * replies.length)];
        var replyMessage = {
          id: Date.now() + 2,
          user: randomUser,
          content: randomReply,
          timestamp: new Date().toISOString(),
          isSelf: false
        };
        setTimeout(function () {
          addMessageToUI(replyMessage);
          scrollToBottom();
        }, 2000 + Math.random() * 3000);
      }
    }, 500);
  }

  // æ·»åŠ æ¶ˆæ¯åˆ°ç•Œé¢
  function addMessageToUI(message) {
    var messageElement = document.createElement('div');
    messageElement.className = "message".concat(message.isSelf ? 'self-message' : 'other-message', "mb-4");

    // æ ¼å¼åŒ–æ—¶é—´
    var time = new Date(message.timestamp);
    var formattedTime = "".concat(time.getHours().toString().padStart(2, '0'), ":").concat(time.getMinutes().toString().padStart(2, '0'));

    // å¤„ç†@æåŠé«˜äº®
    var contentWithHighlights = message.content.replace(/@([^\s]+)/g, '<span class="text-primary font-medium">$&</span>');

    // è®¾ç½®æ¶ˆæ¯å†…å®¹
    if (message.isSelf) {
      messageElement.innerHTML = "<div class=\"flex justify-end\">\n                            <div class=\"max-w-[80%]\">\n                                <div class=\"flex items-center justify-end mb-1\">\n                                    <span class=\"text-xs text-gray-500 mr-2\">".concat(formattedTime, "</span>\n                                    <span class=\"font-medium text-sm\">").concat(message.user.name, "</span>\n                                </div>\n                                <div class=\"bg-primary text-white p-3 rounded-2xl rounded-tr-none shadow-md\">\n                                    <p>").concat(contentWithHighlights, "</p>\n                                </div>\n                            </div>\n                        </div>");
    } else {
      messageElement.innerHTML = "<div class=\"flex\">\n                            <div class=\"w-8 h-8 rounded-full bg-primary/20 flex items-center justify-center text-primary flex-shrink-0 mr-3\">\n                                <span class=\"text-xs font-bold\">".concat(message.user.name.charAt(0), "</span>\n                            </div>\n                            <div class=\"max-w-[80%]\">\n                                <div class=\"flex items-center mb-1\">\n                                    <span class=\"font-medium text-sm\">").concat(message.user.name, "</span>\n                                    <span class=\"text-xs text-gray-500 ml-2\">").concat(formattedTime, "</span>\n                                </div>\n                                <div class=\"bg-gray-100 p-3 rounded-2xl rounded-tl-none shadow-sm\">\n                                    <p>").concat(contentWithHighlights, "</p>\n                                </div>\n                            </div>\n                        </div>");
    }

    // æ·»åŠ åˆ°æ¶ˆæ¯å®¹å™¨
    messageContainer.appendChild(messageElement);
  }

  // æ¥æ”¶æ¶ˆæ¯ï¼ˆä¾›WebSocketå›è°ƒä½¿ç”¨ï¼‰
  window.receiveMessage = function (message) {
    // éšè—ç©ºçŠ¶æ€æç¤º
    if (emptyState) {
      emptyState.remove();
    }

    // æ·»åŠ æ¶ˆæ¯åˆ°ç•Œé¢
    addMessageToUI({
      ...message,
      isSelf: false
    });

    // æ»šåŠ¨åˆ°åº•éƒ¨
    scrollToBottom();

    // æ’­æ”¾æç¤ºéŸ³ï¼ˆå®é™…é¡¹ç›®ä¸­å®ç°ï¼‰
    // playNotificationSound();

    // æ˜¾ç¤ºæ¡Œé¢é€šçŸ¥ï¼ˆå¦‚æœæœ‰æƒé™ï¼‰
    if (Notification.permission === 'granted') {
      new Notification("".concat(message.user.name, "\u8BF4:"), {
        body: message.content,
        icon: 'https://design.gemcoder.com/staticResource/echoAiSystemImages/b4d21ca173681ae1b2bba3e94c67e5a1.png'
      });
    } else if (Notification.permission !== 'denied') {
      Notification.requestPermission();
    }
  };

  // æ»šåŠ¨åˆ°åº•éƒ¨
  function scrollToBottom() {
    messageContainer.scrollTop = messageContainer.scrollHeight;
  }

  // å†å²è®°å½•æŒ‰é’®ç‚¹å‡»äº‹ä»¶
  historyBtn.addEventListener('click', function () {
    showToast('å†å²è®°å½•åŠŸèƒ½æ­£åœ¨å»ºè®¾ä¸­', 'info');
  });

  // æ›´æ–°ç”¨æˆ·åˆ—è¡¨
  window.updateUserList = function (users) {
    // æ›´æ–°ç”¨æˆ·æ•°é‡
    userCount.textContent = users.length;

    // æ¸…ç©ºç°æœ‰åˆ—è¡¨
    userList.innerHTML = '';

    // æ›´æ–°ç§»åŠ¨ç«¯ç”¨æˆ·åˆ—è¡¨
    var mobileUserList = document.getElementById('mobile-user-list');
    if (mobileUserList) {
      mobileUserList.innerHTML = '';
    }

    // æ·»åŠ ç”¨æˆ·åˆ°åˆ—è¡¨
    users.forEach(function (user) {
      var userElement = document.createElement('div');
      userElement.className = "user-item p-2 rounded-lg mb-1 flex items-center transition-colors".concat(user.isSelf ? 'bg-primary/10' : 'hover:bg-gray-100');
      userElement.innerHTML = "<div class=\"w-8 h-8 rounded-full bg-primary/20 flex items-center justify-center text-primary flex-shrink-0 mr-3\">\n                            <span class=\"text-xs font-bold\">".concat(user.name.charAt(0), "</span>\n                        </div>\n                        <div class=\"flex-grow\">\n                            <p class=\"font-medium text-sm\">").concat(user.name, "</p>\n                        </div>").concat(user.isSelf ? '<span class="text-xs bg-primary/20 text-primary px-2 py-0.5 rounded-full">ä½ </span>' : '', "");

      // æ·»åŠ ç‚¹å‡»äº‹ä»¶ï¼Œç”¨äº@ç”¨æˆ·
      userElement.addEventListener('click', function () {
        // å¦‚æœä¸æ˜¯è‡ªå·±æ‰æ·»åŠ @
        if (!user.isSelf) {
          messageInput.value += "@".concat(user.name, "");
          messageInput.focus();

          // æ›´æ–°å­—ç¬¦è®¡æ•°
          charCount.textContent = messageInput.value.length;

          // å…³é—­ç§»åŠ¨ç«¯ç”¨æˆ·åˆ—è¡¨
          closeMobileUserModal();
        }
      });

      // æ·»åŠ åˆ°æ¡Œé¢ç”¨æˆ·åˆ—è¡¨
      userList.appendChild(userElement);

      // æ·»åŠ åˆ°ç§»åŠ¨ç«¯ç”¨æˆ·åˆ—è¡¨
      if (mobileUserList) {
        var mobileUserElement = userElement.cloneNode(true);
        mobileUserList.appendChild(mobileUserElement);
      }
    });
  };
});
// [/JSMOD] z3a_èŠå¤©åŠŸèƒ½ -- å¤„ç†æ¶ˆæ¯å‘é€ã€æ¥æ”¶å’Œæ˜¾ç¤ºï¼Œç®¡ç†ç”¨æˆ·åˆ—è¡¨æ›´æ–°</script>
<!-- [JSMOD] b4c_è¡¨æƒ…åŠŸèƒ½ -->
<script id='emoji-script'>document.addEventListener('DOMContentLoaded', function () {
  var emojiBtn = document.getElementById('emoji-btn');
  var emojiPicker = document.getElementById('emoji-picker');
  var closeEmoji = document.getElementById('close-emoji');
  var emojiContainer = document.getElementById('emoji-container');
  var messageInput = document.getElementById('message-input');

  // å¸¸ç”¨emojiåˆ—è¡¨
  var emojis = ['ğŸ˜€', 'ğŸ˜ƒ', 'ğŸ˜„', 'ğŸ˜', 'ğŸ˜†', 'ğŸ˜…', 'ğŸ˜‚', 'ğŸ¤£', 'ğŸ˜Š', 'ğŸ˜‡', 'ğŸ™‚', 'ğŸ™ƒ', 'ğŸ˜‰', 'ğŸ˜Œ', 'ğŸ˜', 'ğŸ¥°', 'ğŸ˜˜', 'ğŸ˜—', 'ğŸ˜™', 'ğŸ˜š', 'ğŸ˜‹', 'ğŸ˜›', 'ğŸ˜', 'ğŸ˜œ', 'ğŸ¤ª', 'ğŸ¤¨', 'ğŸ§', 'ğŸ¤“', 'ğŸ˜', 'ğŸ¤©', 'ğŸ¥³', 'ğŸ˜', 'ğŸ˜’', 'ğŸ˜', 'ğŸ˜”', 'ğŸ˜Ÿ', 'ğŸ˜•', 'ğŸ™', 'ğŸ˜£', 'ğŸ˜–', 'ğŸ˜«', 'ğŸ˜©', 'ğŸ¥º', 'ğŸ˜¢', 'ğŸ˜­', 'ğŸ˜¤', 'ğŸ˜ ', 'ğŸ˜¡', 'ğŸ¤¬', 'ğŸ¤¯', 'ğŸ˜³', 'ğŸ¥µ', 'ğŸ¥¶', 'ğŸ˜±', 'ğŸ˜¨', 'ğŸ˜°', 'ğŸ˜¥', 'ğŸ˜“', 'ğŸ¤—', 'ğŸ¤”', 'ğŸ¤­', 'ğŸ¤«', 'ğŸ¤¥', 'ğŸ˜¶', 'ğŸ˜', 'ğŸ˜‘', 'ğŸ˜¬', 'ğŸ™„', 'ğŸ˜¯', 'ğŸ˜¦', 'ğŸ˜§', 'ğŸ˜®', 'ğŸ˜²', 'ğŸ¥±', 'ğŸ˜´', 'ğŸ¤¤', 'ğŸ˜ª', 'ğŸ˜µ', 'ğŸ¤', 'ğŸ¥´', 'ğŸ¤¢', 'ğŸ¤®', 'ğŸ¤§', 'ğŸ˜·', 'ğŸ¤’', 'ğŸ¤•', 'ğŸ¤‘', 'ğŸ¤ ', 'ğŸ˜ˆ', 'ğŸ‘¿', 'ğŸ‘¹', 'ğŸ‘º', 'ğŸ¤¡', 'ğŸ’©', 'ğŸ‘»', 'ğŸ’€', 'â˜ ï¸', 'ğŸ‘½', 'ğŸ‘¾', 'ğŸ¤–'];

  // ç”Ÿæˆè¡¨æƒ…é€‰æ‹©å™¨å†…å®¹
  function renderEmojis() {
    emojiContainer.innerHTML = '';
    emojis.forEach(function (emoji) {
      var emojiBtn = document.createElement('button');
      emojiBtn.className = 'emoji-btn p-2 rounded-full hover:bg-gray-100 transition-colors';
      emojiBtn.textContent = emoji;
      emojiBtn.title = emoji;
      emojiBtn.addEventListener('click', function () {
        // å°†è¡¨æƒ…æ’å…¥åˆ°è¾“å…¥æ¡†å…‰æ ‡ä½ç½®
        var cursorPos = messageInput.selectionStart;
        var textBefore = messageInput.value.substring(0, cursorPos);
        var textAfter = messageInput.value.substring(cursorPos);
        messageInput.value = textBefore + emoji + textAfter;

        // ç§»åŠ¨å…‰æ ‡åˆ°è¡¨æƒ…åé¢
        messageInput.selectionStart = cursorPos + 1;
        messageInput.selectionEnd = cursorPos + 1;

        // èšç„¦è¾“å…¥æ¡†
        messageInput.focus();

        // æ›´æ–°å­—ç¬¦è®¡æ•°
        var charCount = document.getElementById('char-count');
        charCount.textContent = messageInput.value.length;
      });
      emojiContainer.appendChild(emojiBtn);
    });
  }

  // åˆå§‹åŒ–è¡¨æƒ…é€‰æ‹©å™¨
  renderEmojis();

  // åˆ‡æ¢è¡¨æƒ…é€‰æ‹©å™¨æ˜¾ç¤º/éšè—
  emojiBtn.addEventListener('click', function () {
    emojiPicker.classList.toggle('hidden');

    // å¦‚æœæ˜¾ç¤ºï¼Œåˆ™å®šä½åœ¨è¾“å…¥æ¡†ä¸Šæ–¹
    if (!emojiPicker.classList.contains('hidden')) {
      var inputRect = messageInput.getBoundingClientRect();
      var pickerRect = emojiPicker.getBoundingClientRect();

      // è°ƒæ•´ä½ç½®
      emojiPicker.style.bottom = "".concat(window.innerHeight - inputRect.top + 10, "px");
    }
  });

  // å…³é—­è¡¨æƒ…é€‰æ‹©å™¨
  closeEmoji.addEventListener('click', function () {
    emojiPicker.classList.add('hidden');
  });

  // ç‚¹å‡»é¡µé¢å…¶ä»–åœ°æ–¹å…³é—­è¡¨æƒ…é€‰æ‹©å™¨
  document.addEventListener('click', function (e) {
    if (!emojiPicker.contains(e.target) && e.target !== emojiBtn) {
      emojiPicker.classList.add('hidden');
    }
  });
});
// [/JSMOD] b4c_è¡¨æƒ…åŠŸèƒ½ -- å®ç°è¡¨æƒ…é€‰æ‹©å™¨ï¼Œå…è®¸ç”¨æˆ·é€‰æ‹©å¹¶æ’å…¥è¡¨æƒ…åˆ°æ¶ˆæ¯ä¸­</script>
<!-- [JSMOD] d6e_ç§»åŠ¨ç«¯é€‚é…åŠŸèƒ½ -->
<script id='mobile-script'>document.addEventListener('DOMContentLoaded', function () {
  var mobileUserBtn = document.getElementById('mobile-user-list-btn');
  var mobileUserModal = document.getElementById('mobile-user-modal');
  var modalContent = document.getElementById('modal-content');
  var closeModal = document.getElementById('close-modal');

  // åˆ›å»ºç§»åŠ¨ç«¯ç”¨æˆ·åˆ—è¡¨å®¹å™¨
  var mobileUserList = document.createElement('div');
  mobileUserList.id = 'mobile-user-list';
  mobileUserList.className = 'p-2 overflow-y-auto h-[calc(70vh-60px)] scrollbar-thin scrollbar-thumb-rounded';
  document.getElementById('modal-content').appendChild(mobileUserList);

  // æ‰“å¼€ç§»åŠ¨ç«¯ç”¨æˆ·åˆ—è¡¨
  mobileUserBtn.addEventListener('click', function () {
    mobileUserModal.classList.remove('hidden');
    // è§¦å‘åŠ¨ç”»
    setTimeout(function () {
      modalContent.classList.remove('translate-y-full');
    }, 10);
  });

  // å…³é—­ç§»åŠ¨ç«¯ç”¨æˆ·åˆ—è¡¨
  closeModal.addEventListener('click', closeMobileUserModal);

  // ç‚¹å‡»æ¨¡æ€æ¡†èƒŒæ™¯å…³é—­
  mobileUserModal.addEventListener('click', function (e) {
    if (e.target === mobileUserModal) {
      closeMobileUserModal();
    }
  });

  // å…³é—­ç§»åŠ¨ç«¯ç”¨æˆ·åˆ—è¡¨å‡½æ•°
  function closeMobileUserModal() {
    modalContent.classList.add('translate-y-full');
    setTimeout(function () {
      mobileUserModal.classList.add('hidden');
    }, 300);
  }

  // å¤„ç†çª—å£å¤§å°å˜åŒ–
  window.addEventListener('resize', function () {
    // åœ¨å¤§å±å¹•ä¸Šå…³é—­ç§»åŠ¨ç«¯ç”¨æˆ·åˆ—è¡¨
    if (window.innerWidth >= 768) {
      mobileUserModal.classList.add('hidden');
      modalContent.classList.add('translate-y-full');
    }
  });
});
// [/JSMOD] d6e_ç§»åŠ¨ç«¯é€‚é…åŠŸèƒ½ -- å®ç°ç§»åŠ¨ç«¯ç”¨æˆ·åˆ—è¡¨å¼¹çª—å’Œå“åº”å¼å¸ƒå±€è°ƒæ•´</script>
    </body>
    </html>
